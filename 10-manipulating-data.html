<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.20">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>10&nbsp; Manipulating Data – BANA 4080: Data Mining</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./11_aggregating_data.html" rel="next">
<link href="./09-subsetting.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-bd0f20613ab34a035844aaae9062fb4e.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-d74427f542abffe98b9cb10ac5538457.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-bd0f20613ab34a035844aaae9062fb4e.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-81617b36c4f17fe6b013498b3c70e979.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-d7db6fc1be087e92b19c52e05fd0c92e.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-81617b36c4f17fe6b013498b3c70e979.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const queryPrefersDark = window.matchMedia('(prefers-color-scheme: dark)');
    const darkModeDefault = queryPrefersDark.matches;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    queryPrefersDark.addEventListener("change", e => {
      if(window.localStorage.getItem("quarto-color-scheme") !== null)
        return;
      const alternate = e.matches
      toggleColorMode(alternate);
      localAlternateSentinel = e.matches ? 'alternate' : 'default'; // this is used alongside local storage!
      toggleGiscusIfUsed(alternate, darkModeDefault);
    });
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./10-manipulating-data.html">Module 4</a></li><li class="breadcrumb-item"><a href="./10-manipulating-data.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Manipulating Data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">BANA 4080: Data Mining</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/bradleyboehmke/uc-bana-4080" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./BANA-4080--Data-Mining.epub" title="Download ePub" class="quarto-navigation-tool px-1" aria-label="Download ePub"><i class="bi bi-journal"></i></a>
    <a href="https://twitter.com/intent/tweet?url=|url|" title="Twitter" class="quarto-navigation-tool px-1" aria-label="Twitter"><i class="bi bi-twitter"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Module 1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro-data-mining.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-preparing-for-code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Setting Up Your Python Environment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-python-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Python Basics – Working with Data and Variables</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Module 2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-jupyter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Getting Started with Jupyter Notebooks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-data-structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to Data Structures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-libraries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Packages, Libraries, and Modules</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Module 3</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-importing-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Importing Data and Exploring Pandas DataFrames</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-dataframes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Deeper Dive on DataFrames</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-subsetting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Subsetting Data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Module 4</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-manipulating-data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Manipulating Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_aggregating_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Summarizing Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-joining-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Relational data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Module 5</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-data-viz-pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Intro to Data Visualization with Pandas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-data-viz-matplotlib.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Fundamentals of Plotting with Matplotlib</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-data-viz-bokeh.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Interactive Data Visualization with Bokeh</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Module 6</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-control-statements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Controlling Program Flow with Conditional Statements</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-iteration-statements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Controlling Repetition with Iteration Statements</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Writing Your Own Functions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendix</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-anaconda-install.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Anaconda Installation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-vscode-install.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">VS Code Installation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-ames-housing-data" id="toc-the-ames-housing-data" class="nav-link active" data-scroll-target="#the-ames-housing-data">The Ames Housing Data</a></li>
  <li><a href="#renaming-columns" id="toc-renaming-columns" class="nav-link" data-scroll-target="#renaming-columns"><span class="header-section-number">10.1</span> Renaming Columns</a>
  <ul class="collapse">
  <li><a href="#renaming-specific-columns" id="toc-renaming-specific-columns" class="nav-link" data-scroll-target="#renaming-specific-columns">Renaming Specific Columns</a></li>
  <li><a href="#renaming-many-columns-at-once" id="toc-renaming-many-columns-at-once" class="nav-link" data-scroll-target="#renaming-many-columns-at-once">Renaming Many Columns at Once</a></li>
  <li><a href="#knowledge-check" id="toc-knowledge-check" class="nav-link" data-scroll-target="#knowledge-check">Knowledge Check</a></li>
  </ul></li>
  <li><a href="#performing-calculations-with-columns" id="toc-performing-calculations-with-columns" class="nav-link" data-scroll-target="#performing-calculations-with-columns"><span class="header-section-number">10.2</span> Performing Calculations with Columns</a></li>
  <li><a href="#adding-and-removing-columns" id="toc-adding-and-removing-columns" class="nav-link" data-scroll-target="#adding-and-removing-columns"><span class="header-section-number">10.3</span> Adding and Removing Columns</a>
  <ul class="collapse">
  <li><a href="#adding-columns" id="toc-adding-columns" class="nav-link" data-scroll-target="#adding-columns">Adding Columns</a></li>
  <li><a href="#removing-columns" id="toc-removing-columns" class="nav-link" data-scroll-target="#removing-columns">Removing Columns</a></li>
  <li><a href="#knowledge-check-1" id="toc-knowledge-check-1" class="nav-link" data-scroll-target="#knowledge-check-1">Knowledge check</a></li>
  </ul></li>
  <li><a href="#overwriting-columns" id="toc-overwriting-columns" class="nav-link" data-scroll-target="#overwriting-columns"><span class="header-section-number">10.4</span> Overwriting columns</a></li>
  <li><a href="#calculating-with-multiple-columns" id="toc-calculating-with-multiple-columns" class="nav-link" data-scroll-target="#calculating-with-multiple-columns"><span class="header-section-number">10.5</span> Calculating with Multiple Columns</a>
  <ul class="collapse">
  <li><a href="#combining-multiple-operations" id="toc-combining-multiple-operations" class="nav-link" data-scroll-target="#combining-multiple-operations">Combining Multiple Operations</a></li>
  <li><a href="#knowledge-check-2" id="toc-knowledge-check-2" class="nav-link" data-scroll-target="#knowledge-check-2">Knowledge check</a></li>
  </ul></li>
  <li><a href="#working-with-string-columns" id="toc-working-with-string-columns" class="nav-link" data-scroll-target="#working-with-string-columns"><span class="header-section-number">10.6</span> Working with String Columns</a>
  <ul class="collapse">
  <li><a href="#string-concatenation" id="toc-string-concatenation" class="nav-link" data-scroll-target="#string-concatenation">String Concatenation</a></li>
  <li><a href="#string-methods-with-.str" id="toc-string-methods-with-.str" class="nav-link" data-scroll-target="#string-methods-with-.str">String Methods with <code>.str</code></a></li>
  </ul></li>
  <li><a href="#more-complex-column-manipulation" id="toc-more-complex-column-manipulation" class="nav-link" data-scroll-target="#more-complex-column-manipulation"><span class="header-section-number">10.7</span> More Complex Column Manipulation</a>
  <ul class="collapse">
  <li><a href="#replacing-values" id="toc-replacing-values" class="nav-link" data-scroll-target="#replacing-values">Replacing Values</a></li>
  <li><a href="#missing-values" id="toc-missing-values" class="nav-link" data-scroll-target="#missing-values">Missing values</a></li>
  <li><a href="#applying-custom-functions" id="toc-applying-custom-functions" class="nav-link" data-scroll-target="#applying-custom-functions">Applying custom functions</a></li>
  </ul></li>
  <li><a href="#chapter-summary" id="toc-chapter-summary" class="nav-link" data-scroll-target="#chapter-summary"><span class="header-section-number">10.8</span> Chapter Summary</a></li>
  <li><a href="#exercise-heart-disease-data" id="toc-exercise-heart-disease-data" class="nav-link" data-scroll-target="#exercise-heart-disease-data"><span class="header-section-number">10.9</span> Exercise: Heart Disease Data</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/bradleyboehmke/uc-bana-4080/edit/main/10-manipulating-data.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/bradleyboehmke/uc-bana-4080/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./10-manipulating-data.html">Module 4</a></li><li class="breadcrumb-item"><a href="./10-manipulating-data.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Manipulating Data</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Manipulating Data</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p><em>“During the course of doing data analysis and modeling, a significant amount of time is spent on data preparation: loading, cleaning, transforming, and rearranging. Such tasks are often reported to take up 80% or more of an analyst’s time.”</em> — Wes McKinney, creator of Pandas, in <em>Python for Data Analysis</em></p>
</blockquote>
<p>In our previous chapter, we explored how to access, index, and subset data from a <code>pandas</code> DataFrame. These are essential skills for understanding and navigating real-world datasets. Now we take the next step: learning how to <strong>manipulate</strong> data.</p>
<p>As a data analyst or scientist, you will spend much of your time transforming raw data into something clean, interpretable, and analysis-ready. This chapter provides the foundation for doing just that. You’ll learn to rename columns, create new variables, deal with missing values, and apply functions to your data — all of which are fundamental skills in the data science workflow.</p>
<p>By the end of this chapter, you will be able to:</p>
<ul>
<li>Rename and reformat column names</li>
<li>Perform arithmetic operations on columns</li>
<li>Add, drop, and overwrite columns in a DataFrame</li>
<li>Handle missing values using identification and imputation techniques</li>
<li>Apply custom functions to DataFrame columns using <code>.apply()</code> and <code>.map()</code></li>
</ul>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>📓 Follow Along in Colab!
</div>
</div>
<div class="callout-body-container callout-body">
<p>As you read through this chapter, we encourage you to follow along using the <a href="https://github.com/bradleyboehmke/uc-bana-4080/blob/main/example-notebooks/09_manipulating_data.ipynb">companion notebook</a> in Google Colab (or other editor of choice). This interactive notebook lets you run code examples covered in the chapter—and experiment with your own ideas.</p>
<p>👉 Open the <a href="https://colab.research.google.com/github/bradleyboehmke/uc-bana-4080/blob/main/example-notebooks/09_manipulating_data.ipynb">Manipulating Data Notebook in Colab</a>.</p>
</div>
</div>
<section id="the-ames-housing-data" class="level3">
<h3 class="anchored" data-anchor-id="the-ames-housing-data">The Ames Housing Data</h3>
<p>You first encountered the <a href="https://github.com/bradleyboehmke/uc-bana-4080/blob/main/data/ames_raw.csv"><strong>Ames Housing</strong> dataset</a> back in <a href="07-importing-data.html" class="quarto-xref"><span>Chapter 7</span></a>, where you were challenged with the task of analyzing raw data for the Ames, Iowa housing market. In this chapter, we’ll return to the Ames data as our primary example to learn how to manipulate and prepare real-world data for analysis.</p>
<p>Before diving into the new concepts, take a few minutes to reacquaint yourself with the data:</p>
<ul>
<li>How many <strong>observations</strong> are included?</li>
<li>What <strong>variables</strong> (columns) are present, and what kinds of information do they represent?</li>
<li>Can you spot any <strong>potential issues</strong> — such as inconsistent naming, unclear variable descriptions, or missing values — that might need to be addressed?</li>
</ul>
<p>Let’s begin by loading the dataset and inspecting the first few rows:</p>
<div id="8cd9a1e3" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>ames <span class="op">=</span> pd.read_csv(<span class="st">'../data/ames_raw.csv'</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>ames.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Order</th>
<th data-quarto-table-cell-role="th">PID</th>
<th data-quarto-table-cell-role="th">MS SubClass</th>
<th data-quarto-table-cell-role="th">MS Zoning</th>
<th data-quarto-table-cell-role="th">Lot Frontage</th>
<th data-quarto-table-cell-role="th">Lot Area</th>
<th data-quarto-table-cell-role="th">Street</th>
<th data-quarto-table-cell-role="th">Alley</th>
<th data-quarto-table-cell-role="th">Lot Shape</th>
<th data-quarto-table-cell-role="th">Land Contour</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Pool Area</th>
<th data-quarto-table-cell-role="th">Pool QC</th>
<th data-quarto-table-cell-role="th">Fence</th>
<th data-quarto-table-cell-role="th">Misc Feature</th>
<th data-quarto-table-cell-role="th">Misc Val</th>
<th data-quarto-table-cell-role="th">Mo Sold</th>
<th data-quarto-table-cell-role="th">Yr Sold</th>
<th data-quarto-table-cell-role="th">Sale Type</th>
<th data-quarto-table-cell-role="th">Sale Condition</th>
<th data-quarto-table-cell-role="th">SalePrice</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>1</td>
<td>526301100</td>
<td>20</td>
<td>RL</td>
<td>141.0</td>
<td>31770</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>5</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>215000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2</td>
<td>526350040</td>
<td>20</td>
<td>RH</td>
<td>80.0</td>
<td>11622</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>105000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>3</td>
<td>526351010</td>
<td>20</td>
<td>RL</td>
<td>81.0</td>
<td>14267</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>Gar2</td>
<td>12500</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>172000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>4</td>
<td>526353030</td>
<td>20</td>
<td>RL</td>
<td>93.0</td>
<td>11160</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>4</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>244000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>5</td>
<td>527105010</td>
<td>60</td>
<td>RL</td>
<td>74.0</td>
<td>13830</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>3</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>189900</td>
</tr>
</tbody>
</table>

<p>5 rows × 82 columns</p>
</div>
</div>
</div>
<p>We’ll use this dataset throughout the chapter to demonstrate how to rename columns, compute new variables, handle missing data, and apply transformations — all crucial steps in cleaning and preparing data for analysis and modeling.</p>
</section>
<section id="renaming-columns" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="renaming-columns"><span class="header-section-number">10.1</span> Renaming Columns</h2>
<p>One of the first things you’ll often do when working with a new dataset is <strong>clean up the column names</strong>. Column names might contain spaces, inconsistent capitalization, or other formatting quirks that make them harder to work with in code. In this section, we’ll walk through a few ways to rename columns in a DataFrame using the Ames Housing dataset.</p>
<p>Let’s start by looking at the current column names:</p>
<div id="9e4d3757" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ames.columns</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>Index(['Order', 'PID', 'MS SubClass', 'MS Zoning', 'Lot Frontage', 'Lot Area',
       'Street', 'Alley', 'Lot Shape', 'Land Contour', 'Utilities',
       'Lot Config', 'Land Slope', 'Neighborhood', 'Condition 1',
       'Condition 2', 'Bldg Type', 'House Style', 'Overall Qual',
       'Overall Cond', 'Year Built', 'Year Remod/Add', 'Roof Style',
       'Roof Matl', 'Exterior 1st', 'Exterior 2nd', 'Mas Vnr Type',
       'Mas Vnr Area', 'Exter Qual', 'Exter Cond', 'Foundation', 'Bsmt Qual',
       'Bsmt Cond', 'Bsmt Exposure', 'BsmtFin Type 1', 'BsmtFin SF 1',
       'BsmtFin Type 2', 'BsmtFin SF 2', 'Bsmt Unf SF', 'Total Bsmt SF',
       'Heating', 'Heating QC', 'Central Air', 'Electrical', '1st Flr SF',
       '2nd Flr SF', 'Low Qual Fin SF', 'Gr Liv Area', 'Bsmt Full Bath',
       'Bsmt Half Bath', 'Full Bath', 'Half Bath', 'Bedroom AbvGr',
       'Kitchen AbvGr', 'Kitchen Qual', 'TotRms AbvGrd', 'Functional',
       'Fireplaces', 'Fireplace Qu', 'Garage Type', 'Garage Yr Blt',
       'Garage Finish', 'Garage Cars', 'Garage Area', 'Garage Qual',
       'Garage Cond', 'Paved Drive', 'Wood Deck SF', 'Open Porch SF',
       'Enclosed Porch', '3Ssn Porch', 'Screen Porch', 'Pool Area', 'Pool QC',
       'Fence', 'Misc Feature', 'Misc Val', 'Mo Sold', 'Yr Sold', 'Sale Type',
       'Sale Condition', 'SalePrice'],
      dtype='object')</code></pre>
</div>
</div>
<p>You might notice that some of these column names contain spaces or uppercase letters, such as <code>"MS SubClass"</code> and <code>"MS Zoning"</code>. These formatting issues can be inconvenient when writing code — especially if you’re trying to access a column using dot notation (e.g., <code>df.column_name</code>) or when using string methods.</p>
<section id="renaming-specific-columns" class="level3">
<h3 class="anchored" data-anchor-id="renaming-specific-columns">Renaming Specific Columns</h3>
<p>We can rename one or more columns using the <code>.rename()</code> method. This method accepts a dictionary where the keys are the original column names and the values are the new names you’d like to assign.</p>
<div id="72a3eaeb" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ames.rename(columns<span class="op">=</span>{<span class="st">'MS SubClass'</span>: <span class="st">'ms_subclass'</span>, <span class="st">'MS Zoning'</span>: <span class="st">'ms_zoning'</span>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Order</th>
<th data-quarto-table-cell-role="th">PID</th>
<th data-quarto-table-cell-role="th">ms_subclass</th>
<th data-quarto-table-cell-role="th">ms_zoning</th>
<th data-quarto-table-cell-role="th">Lot Frontage</th>
<th data-quarto-table-cell-role="th">Lot Area</th>
<th data-quarto-table-cell-role="th">Street</th>
<th data-quarto-table-cell-role="th">Alley</th>
<th data-quarto-table-cell-role="th">Lot Shape</th>
<th data-quarto-table-cell-role="th">Land Contour</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Pool Area</th>
<th data-quarto-table-cell-role="th">Pool QC</th>
<th data-quarto-table-cell-role="th">Fence</th>
<th data-quarto-table-cell-role="th">Misc Feature</th>
<th data-quarto-table-cell-role="th">Misc Val</th>
<th data-quarto-table-cell-role="th">Mo Sold</th>
<th data-quarto-table-cell-role="th">Yr Sold</th>
<th data-quarto-table-cell-role="th">Sale Type</th>
<th data-quarto-table-cell-role="th">Sale Condition</th>
<th data-quarto-table-cell-role="th">SalePrice</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>1</td>
<td>526301100</td>
<td>20</td>
<td>RL</td>
<td>141.0</td>
<td>31770</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>5</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>215000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2</td>
<td>526350040</td>
<td>20</td>
<td>RH</td>
<td>80.0</td>
<td>11622</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>105000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>3</td>
<td>526351010</td>
<td>20</td>
<td>RL</td>
<td>81.0</td>
<td>14267</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>Gar2</td>
<td>12500</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>172000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>4</td>
<td>526353030</td>
<td>20</td>
<td>RL</td>
<td>93.0</td>
<td>11160</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>4</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>244000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>5</td>
<td>527105010</td>
<td>60</td>
<td>RL</td>
<td>74.0</td>
<td>13830</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>3</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>189900</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2925</th>
<td>2926</td>
<td>923275080</td>
<td>80</td>
<td>RL</td>
<td>37.0</td>
<td>7937</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>GdPrv</td>
<td>NaN</td>
<td>0</td>
<td>3</td>
<td>2006</td>
<td>WD</td>
<td>Normal</td>
<td>142500</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2926</th>
<td>2927</td>
<td>923276100</td>
<td>20</td>
<td>RL</td>
<td>NaN</td>
<td>8885</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Low</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>6</td>
<td>2006</td>
<td>WD</td>
<td>Normal</td>
<td>131000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2927</th>
<td>2928</td>
<td>923400125</td>
<td>85</td>
<td>RL</td>
<td>62.0</td>
<td>10441</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>MnPrv</td>
<td>Shed</td>
<td>700</td>
<td>7</td>
<td>2006</td>
<td>WD</td>
<td>Normal</td>
<td>132000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2928</th>
<td>2929</td>
<td>924100070</td>
<td>20</td>
<td>RL</td>
<td>77.0</td>
<td>10010</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>4</td>
<td>2006</td>
<td>WD</td>
<td>Normal</td>
<td>170000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2929</th>
<td>2930</td>
<td>924151050</td>
<td>60</td>
<td>RL</td>
<td>74.0</td>
<td>9627</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>11</td>
<td>2006</td>
<td>WD</td>
<td>Normal</td>
<td>188000</td>
</tr>
</tbody>
</table>

<p>2930 rows × 82 columns</p>
</div>
</div>
</div>
<p>This command runs without error; and if we check out our data (below) nothing seems different. Why?</p>
<div id="e3bf0ef9" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ames.head(<span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Order</th>
<th data-quarto-table-cell-role="th">PID</th>
<th data-quarto-table-cell-role="th">MS SubClass</th>
<th data-quarto-table-cell-role="th">MS Zoning</th>
<th data-quarto-table-cell-role="th">Lot Frontage</th>
<th data-quarto-table-cell-role="th">Lot Area</th>
<th data-quarto-table-cell-role="th">Street</th>
<th data-quarto-table-cell-role="th">Alley</th>
<th data-quarto-table-cell-role="th">Lot Shape</th>
<th data-quarto-table-cell-role="th">Land Contour</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Pool Area</th>
<th data-quarto-table-cell-role="th">Pool QC</th>
<th data-quarto-table-cell-role="th">Fence</th>
<th data-quarto-table-cell-role="th">Misc Feature</th>
<th data-quarto-table-cell-role="th">Misc Val</th>
<th data-quarto-table-cell-role="th">Mo Sold</th>
<th data-quarto-table-cell-role="th">Yr Sold</th>
<th data-quarto-table-cell-role="th">Sale Type</th>
<th data-quarto-table-cell-role="th">Sale Condition</th>
<th data-quarto-table-cell-role="th">SalePrice</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>1</td>
<td>526301100</td>
<td>20</td>
<td>RL</td>
<td>141.0</td>
<td>31770</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>5</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>215000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2</td>
<td>526350040</td>
<td>20</td>
<td>RH</td>
<td>80.0</td>
<td>11622</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>105000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>3</td>
<td>526351010</td>
<td>20</td>
<td>RL</td>
<td>81.0</td>
<td>14267</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>Gar2</td>
<td>12500</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>172000</td>
</tr>
</tbody>
</table>

<p>3 rows × 82 columns</p>
</div>
</div>
</div>
<p>That’s because <code>.rename()</code> returns a new DataFrame with the updated names, but it <strong>does not modify the original DataFrame unless you explicitly tell it to</strong>.</p>
<p>There are two common ways to make these changes permanent:</p>
<ol type="1">
<li>Use the <code>inplace=True</code> argument</li>
<li>Reassign the modified DataFrame to the same variable</li>
</ol>
<p>The Pandas development team recommends the second approach (reassigning) for most use cases, as it leads to clearer and more predictable code.</p>
<div id="e0b0904a" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ames <span class="op">=</span> ames.rename(columns<span class="op">=</span>{<span class="st">'MS SubClass'</span>: <span class="st">'ms_subclass'</span>, <span class="st">'MS Zoning'</span>: <span class="st">'ms_zoning'</span>})</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>ames.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Order</th>
<th data-quarto-table-cell-role="th">PID</th>
<th data-quarto-table-cell-role="th">ms_subclass</th>
<th data-quarto-table-cell-role="th">ms_zoning</th>
<th data-quarto-table-cell-role="th">Lot Frontage</th>
<th data-quarto-table-cell-role="th">Lot Area</th>
<th data-quarto-table-cell-role="th">Street</th>
<th data-quarto-table-cell-role="th">Alley</th>
<th data-quarto-table-cell-role="th">Lot Shape</th>
<th data-quarto-table-cell-role="th">Land Contour</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Pool Area</th>
<th data-quarto-table-cell-role="th">Pool QC</th>
<th data-quarto-table-cell-role="th">Fence</th>
<th data-quarto-table-cell-role="th">Misc Feature</th>
<th data-quarto-table-cell-role="th">Misc Val</th>
<th data-quarto-table-cell-role="th">Mo Sold</th>
<th data-quarto-table-cell-role="th">Yr Sold</th>
<th data-quarto-table-cell-role="th">Sale Type</th>
<th data-quarto-table-cell-role="th">Sale Condition</th>
<th data-quarto-table-cell-role="th">SalePrice</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>1</td>
<td>526301100</td>
<td>20</td>
<td>RL</td>
<td>141.0</td>
<td>31770</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>5</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>215000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2</td>
<td>526350040</td>
<td>20</td>
<td>RH</td>
<td>80.0</td>
<td>11622</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>105000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>3</td>
<td>526351010</td>
<td>20</td>
<td>RL</td>
<td>81.0</td>
<td>14267</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>Gar2</td>
<td>12500</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>172000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>4</td>
<td>526353030</td>
<td>20</td>
<td>RL</td>
<td>93.0</td>
<td>11160</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>4</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>244000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>5</td>
<td>527105010</td>
<td>60</td>
<td>RL</td>
<td>74.0</td>
<td>13830</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>3</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>189900</td>
</tr>
</tbody>
</table>

<p>5 rows × 82 columns</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Always include <code>columns=</code> when using <code>.rename()</code>. If you don’t, Pandas will assume you are renaming <strong>index</strong> values instead of column names — and it won’t raise a warning or error if you make this mistake.</p>
</div>
</div>
</div>
</section>
<section id="renaming-many-columns-at-once" class="level3">
<h3 class="anchored" data-anchor-id="renaming-many-columns-at-once">Renaming Many Columns at Once</h3>
<p>Using <code>.rename()</code> works well for renaming one or two columns. But if you want to rename <strong>many</strong> columns — such as applying a consistent format across the entire DataFrame — it’s more efficient to use the <code>.columns</code> attribute and vectorized string methods.</p>
<p>Pandas provides powerful tools for working with strings through the <code>.str</code> accessor. For example, we can convert all column names to lowercase like this:</p>
<div id="a8c054a6" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ames.columns.<span class="bu">str</span>.lower()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>Index(['order', 'pid', 'ms_subclass', 'ms_zoning', 'lot frontage', 'lot area',
       'street', 'alley', 'lot shape', 'land contour', 'utilities',
       'lot config', 'land slope', 'neighborhood', 'condition 1',
       'condition 2', 'bldg type', 'house style', 'overall qual',
       'overall cond', 'year built', 'year remod/add', 'roof style',
       'roof matl', 'exterior 1st', 'exterior 2nd', 'mas vnr type',
       'mas vnr area', 'exter qual', 'exter cond', 'foundation', 'bsmt qual',
       'bsmt cond', 'bsmt exposure', 'bsmtfin type 1', 'bsmtfin sf 1',
       'bsmtfin type 2', 'bsmtfin sf 2', 'bsmt unf sf', 'total bsmt sf',
       'heating', 'heating qc', 'central air', 'electrical', '1st flr sf',
       '2nd flr sf', 'low qual fin sf', 'gr liv area', 'bsmt full bath',
       'bsmt half bath', 'full bath', 'half bath', 'bedroom abvgr',
       'kitchen abvgr', 'kitchen qual', 'totrms abvgrd', 'functional',
       'fireplaces', 'fireplace qu', 'garage type', 'garage yr blt',
       'garage finish', 'garage cars', 'garage area', 'garage qual',
       'garage cond', 'paved drive', 'wood deck sf', 'open porch sf',
       'enclosed porch', '3ssn porch', 'screen porch', 'pool area', 'pool qc',
       'fence', 'misc feature', 'misc val', 'mo sold', 'yr sold', 'sale type',
       'sale condition', 'saleprice'],
      dtype='object')</code></pre>
</div>
</div>
<p>Or, we can chain multiple string methods together to standardize our column names — converting them to lowercase and replacing all spaces with underscores:</p>
<div id="710abbc1" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ames.columns <span class="op">=</span> ames.columns.<span class="bu">str</span>.lower().<span class="bu">str</span>.replace(<span class="st">" "</span>, <span class="st">"_"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>ames.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">order</th>
<th data-quarto-table-cell-role="th">pid</th>
<th data-quarto-table-cell-role="th">ms_subclass</th>
<th data-quarto-table-cell-role="th">ms_zoning</th>
<th data-quarto-table-cell-role="th">lot_frontage</th>
<th data-quarto-table-cell-role="th">lot_area</th>
<th data-quarto-table-cell-role="th">street</th>
<th data-quarto-table-cell-role="th">alley</th>
<th data-quarto-table-cell-role="th">lot_shape</th>
<th data-quarto-table-cell-role="th">land_contour</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">pool_area</th>
<th data-quarto-table-cell-role="th">pool_qc</th>
<th data-quarto-table-cell-role="th">fence</th>
<th data-quarto-table-cell-role="th">misc_feature</th>
<th data-quarto-table-cell-role="th">misc_val</th>
<th data-quarto-table-cell-role="th">mo_sold</th>
<th data-quarto-table-cell-role="th">yr_sold</th>
<th data-quarto-table-cell-role="th">sale_type</th>
<th data-quarto-table-cell-role="th">sale_condition</th>
<th data-quarto-table-cell-role="th">saleprice</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>1</td>
<td>526301100</td>
<td>20</td>
<td>RL</td>
<td>141.0</td>
<td>31770</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>5</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>215000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2</td>
<td>526350040</td>
<td>20</td>
<td>RH</td>
<td>80.0</td>
<td>11622</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>105000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>3</td>
<td>526351010</td>
<td>20</td>
<td>RL</td>
<td>81.0</td>
<td>14267</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>Gar2</td>
<td>12500</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>172000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>4</td>
<td>526353030</td>
<td>20</td>
<td>RL</td>
<td>93.0</td>
<td>11160</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>4</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>244000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>5</td>
<td>527105010</td>
<td>60</td>
<td>RL</td>
<td>74.0</td>
<td>13830</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>3</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>189900</td>
</tr>
</tbody>
</table>

<p>5 rows × 82 columns</p>
</div>
</div>
</div>
<p>This makes your column names easier to type, more consistent, and less prone to errors in your code.</p>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>You can explore other string operations that work with <code>.str</code> by checking out the <a href="https://pandas.pydata.org/docs/user_guide/text.html#string-methods">Pandas string methods documentation</a>.</p>
</div>
</div>
</div>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/jPWBtOIh6_8?si=Bxro1M4gKIC6dhVE" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</section>
<section id="knowledge-check" class="level3">
<h3 class="anchored" data-anchor-id="knowledge-check">Knowledge Check</h3>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Try This!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let’s practice cleaning up messy column names using the techniques from this section. Below is a small example dataset with inconsistent column names:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'First Name'</span>: [<span class="st">'Alice'</span>, <span class="st">'Bob'</span>, <span class="st">'Charlie'</span>],</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Last-Name'</span>: [<span class="st">'Smith'</span>, <span class="st">'Jones'</span>, <span class="st">'Brown'</span>],</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AGE '</span>: [<span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">22</span>],</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Email Address'</span>: [<span class="st">'alice@example.com'</span>, <span class="st">'bob@example.com'</span>, <span class="st">'charlie@example.com'</span>]</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Your task:</p>
<ol type="1">
<li><strong>Print the current column names.</strong> What formatting issues do you see?</li>
<li><strong>Clean the column names</strong> by doing the following:
<ul>
<li>Convert all column names to lowercase</li>
<li>Replace any spaces or hyphens with underscores</li>
<li>Strip any leading or trailing whitespace</li>
</ul></li>
<li><strong>Assign the cleaned column names back to the DataFrame.</strong></li>
<li><strong>Print the updated column names</strong> and confirm the changes.</li>
</ol>
<p><em>Hint:</em> <code>.columns.str.lower()</code>, <code>.str.replace()</code>, and <code>.str.strip()</code> will come in handy here!</p>
</div>
</div>
</section>
</section>
<section id="performing-calculations-with-columns" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="performing-calculations-with-columns"><span class="header-section-number">10.2</span> Performing Calculations with Columns</h2>
<p>Once your data is loaded and your columns are cleaned up, the next common task is to <strong>perform calculations on your data</strong>. This might include creating new variables, transforming existing values, or applying arithmetic operations across columns.</p>
<p>Let’s begin by focusing on the <code>saleprice</code> column in the Ames Housing dataset. This column records the sale price of each home in dollars. For example:</p>
<div id="41938fd7" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sale_price <span class="op">=</span> ames[<span class="st">'saleprice'</span>]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>sale_price</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>0       215000
1       105000
2       172000
3       244000
4       189900
         ...  
2925    142500
2926    131000
2927    132000
2928    170000
2929    188000
Name: saleprice, Length: 2930, dtype: int64</code></pre>
</div>
</div>
<p>These numbers are fairly large — often six digits long. In many analyses or visualizations, it can be helpful to express values in <strong>thousands of dollars</strong> instead of raw dollar amounts.</p>
<p>To convert the sale price to thousands, we simply divide each value by 1,000:</p>
<div id="e7a6ae6b" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>sale_price_k <span class="op">=</span> sale_price <span class="op">/</span> <span class="dv">1000</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>sale_price_k</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>0       215.0
1       105.0
2       172.0
3       244.0
4       189.9
        ...  
2925    142.5
2926    131.0
2927    132.0
2928    170.0
2929    188.0
Name: saleprice, Length: 2930, dtype: float64</code></pre>
</div>
</div>
<p>This results in a new <code>Series</code> where each home’s price is now shown in thousands. For instance, a home that originally sold for <code>$215,000</code> is now shown as <code>215.0</code>.</p>
<p>At this point, <code>sale_price_k</code> is a new object that exists separately from the <code>ames</code> DataFrame. In the next section, we’ll learn how to add this new variable as a column in our DataFrame so we can use it in further analysis.</p>
</section>
<section id="adding-and-removing-columns" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="adding-and-removing-columns"><span class="header-section-number">10.3</span> Adding and Removing Columns</h2>
<p>Once you’ve created a new variable — like <code>sale_price_k</code> in the previous section — you’ll often want to <strong>add it to your existing DataFrame</strong> so it becomes part of the dataset you’re working with.</p>
<section id="adding-columns" class="level3">
<h3 class="anchored" data-anchor-id="adding-columns">Adding Columns</h3>
<p>In <code>pandas</code>, you can add a new column to a DataFrame using assignment syntax:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example syntax</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'new_column_name'</span>] <span class="op">=</span> new_column_series</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Let’s add the <code>sale_price_k</code> series (which represents sale prices in thousands) to the <code>ames</code> DataFrame:</p>
<div id="7b59405d" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ames[<span class="st">'sale_price_k'</span>] <span class="op">=</span> sale_price_k</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ames.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">order</th>
<th data-quarto-table-cell-role="th">pid</th>
<th data-quarto-table-cell-role="th">ms_subclass</th>
<th data-quarto-table-cell-role="th">ms_zoning</th>
<th data-quarto-table-cell-role="th">lot_frontage</th>
<th data-quarto-table-cell-role="th">lot_area</th>
<th data-quarto-table-cell-role="th">street</th>
<th data-quarto-table-cell-role="th">alley</th>
<th data-quarto-table-cell-role="th">lot_shape</th>
<th data-quarto-table-cell-role="th">land_contour</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">pool_qc</th>
<th data-quarto-table-cell-role="th">fence</th>
<th data-quarto-table-cell-role="th">misc_feature</th>
<th data-quarto-table-cell-role="th">misc_val</th>
<th data-quarto-table-cell-role="th">mo_sold</th>
<th data-quarto-table-cell-role="th">yr_sold</th>
<th data-quarto-table-cell-role="th">sale_type</th>
<th data-quarto-table-cell-role="th">sale_condition</th>
<th data-quarto-table-cell-role="th">saleprice</th>
<th data-quarto-table-cell-role="th">sale_price_k</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>1</td>
<td>526301100</td>
<td>20</td>
<td>RL</td>
<td>141.0</td>
<td>31770</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>5</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>215000</td>
<td>215.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2</td>
<td>526350040</td>
<td>20</td>
<td>RH</td>
<td>80.0</td>
<td>11622</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>...</td>
<td>NaN</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>105000</td>
<td>105.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>3</td>
<td>526351010</td>
<td>20</td>
<td>RL</td>
<td>81.0</td>
<td>14267</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>Gar2</td>
<td>12500</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>172000</td>
<td>172.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>4</td>
<td>526353030</td>
<td>20</td>
<td>RL</td>
<td>93.0</td>
<td>11160</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>4</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>244000</td>
<td>244.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>5</td>
<td>527105010</td>
<td>60</td>
<td>RL</td>
<td>74.0</td>
<td>13830</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>...</td>
<td>NaN</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>3</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>189900</td>
<td>189.9</td>
</tr>
</tbody>
</table>

<p>5 rows × 83 columns</p>
</div>
</div>
</div>
<p>Now, you’ll see that a new column called <code>"sale_price_k"</code> appears at the end of the DataFrame.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Notice how the column name (<code>'sale_price_k'</code>) is placed in quotes inside the brackets on the left-hand side, while the <code>Series</code> providing the data goes on the right-hand side without quotes or brackets.</p>
</div>
</div>
</div>
<p>This entire process can be done in a single step, without creating an intermediate variable:</p>
<div id="4885b130" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ames[<span class="st">'sale_price_k'</span>] <span class="op">=</span> ames[<span class="st">'saleprice'</span>] <span class="op">/</span> <span class="dv">1000</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>This kind of operation is common in data science. What we’re doing here is applying <strong>vectorized math</strong> — performing arithmetic between a <code>Series</code> (a vector of values) and a scalar (a single constant value).</p>
<p>Here are a few more examples:</p>
<div id="37fdbc4c" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subtracting a scalar from a Series</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>(ames[<span class="st">'saleprice'</span>] <span class="op">-</span> <span class="dv">12</span>).head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>0    214988
1    104988
2    171988
3    243988
4    189888
Name: saleprice, dtype: int64</code></pre>
</div>
</div>
<div id="76beac13" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiplying a Series by a scalar</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>(ames[<span class="st">'saleprice'</span>] <span class="op">*</span> <span class="dv">10</span>).head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>0    2150000
1    1050000
2    1720000
3    2440000
4    1899000
Name: saleprice, dtype: int64</code></pre>
</div>
</div>
<div id="dd5a0c86" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Raising a Series to a power</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>(ames[<span class="st">'saleprice'</span>] <span class="op">**</span> <span class="dv">2</span>).head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>0    46225000000
1    11025000000
2    29584000000
3    59536000000
4    36062010000
Name: saleprice, dtype: int64</code></pre>
</div>
</div>
<p>Vectorized operations like these are fast, efficient, and more readable than writing explicit loops.</p>
</section>
<section id="removing-columns" class="level3">
<h3 class="anchored" data-anchor-id="removing-columns">Removing Columns</h3>
<p>Just as easily as we can add columns, we can also remove them. This is helpful when a column is no longer needed or was created only temporarily.</p>
<p>To drop one or more columns from a DataFrame, use the <code>.drop()</code> method with the <code>columns=</code> argument:</p>
<div id="be6b43f0" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ames <span class="op">=</span> ames.drop(columns<span class="op">=</span>[<span class="st">'order'</span>, <span class="st">'sale_price_k'</span>])</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>ames.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">pid</th>
<th data-quarto-table-cell-role="th">ms_subclass</th>
<th data-quarto-table-cell-role="th">ms_zoning</th>
<th data-quarto-table-cell-role="th">lot_frontage</th>
<th data-quarto-table-cell-role="th">lot_area</th>
<th data-quarto-table-cell-role="th">street</th>
<th data-quarto-table-cell-role="th">alley</th>
<th data-quarto-table-cell-role="th">lot_shape</th>
<th data-quarto-table-cell-role="th">land_contour</th>
<th data-quarto-table-cell-role="th">utilities</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">pool_area</th>
<th data-quarto-table-cell-role="th">pool_qc</th>
<th data-quarto-table-cell-role="th">fence</th>
<th data-quarto-table-cell-role="th">misc_feature</th>
<th data-quarto-table-cell-role="th">misc_val</th>
<th data-quarto-table-cell-role="th">mo_sold</th>
<th data-quarto-table-cell-role="th">yr_sold</th>
<th data-quarto-table-cell-role="th">sale_type</th>
<th data-quarto-table-cell-role="th">sale_condition</th>
<th data-quarto-table-cell-role="th">saleprice</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>526301100</td>
<td>20</td>
<td>RL</td>
<td>141.0</td>
<td>31770</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>5</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>215000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>526350040</td>
<td>20</td>
<td>RH</td>
<td>80.0</td>
<td>11622</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>105000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>526351010</td>
<td>20</td>
<td>RL</td>
<td>81.0</td>
<td>14267</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>Gar2</td>
<td>12500</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>172000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>526353030</td>
<td>20</td>
<td>RL</td>
<td>93.0</td>
<td>11160</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>4</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>244000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>527105010</td>
<td>60</td>
<td>RL</td>
<td>74.0</td>
<td>13830</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>3</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>189900</td>
</tr>
</tbody>
</table>

<p>5 rows × 81 columns</p>
</div>
</div>
</div>
<p>This removes the <code>"order"</code> and <code>"sale_price_k"</code> columns from the DataFrame. Remember that most <code>pandas</code> methods return a <strong>new</strong> DataFrame by default, so you’ll need to reassign the result back to <code>ames</code> (or another variable) to make the change permanent.</p>
</section>
<section id="knowledge-check-1" class="level3">
<h3 class="anchored" data-anchor-id="knowledge-check-1">Knowledge check</h3>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Create a <code>utility_space</code> variable
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Create a new column <code>utility_space</code> that is 1/5 of the above ground living space (<code>gr_liv_area</code>).</li>
<li>You will get fractional output with step #1. See if you can figure out how to round this output to the nearest integer.</li>
<li>Now remove this column from your DataFrame</li>
</ol>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/9ZKoOjCnxhc?si=KGWb3l9HjvBWjCf2" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</div>
</div>
</section>
</section>
<section id="overwriting-columns" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="overwriting-columns"><span class="header-section-number">10.4</span> Overwriting columns</h2>
<p>What if we discovered a systematic error in our data? Perhaps we find out that the “lot_area” column is not entirely accurate because the recording process includes an extra 50 square feet for every property. We could create a new column, “real_lot_area” but we’re not going to need the original “lot_area” column, and leaving it could cause confusion for others looking at our data.</p>
<p>A better solution would be to replace the original column with the new, recalculated, values. We can do so using the same syntax as for creating a new column.</p>
<div id="f8d1b372" class="cell" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subtract 50 from lot area, and then overwrite the original data.</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>ames[<span class="st">'lot_area'</span>] <span class="op">=</span> ames[<span class="st">'lot_area'</span>] <span class="op">-</span> <span class="dv">50</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>ames.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">pid</th>
<th data-quarto-table-cell-role="th">ms_subclass</th>
<th data-quarto-table-cell-role="th">ms_zoning</th>
<th data-quarto-table-cell-role="th">lot_frontage</th>
<th data-quarto-table-cell-role="th">lot_area</th>
<th data-quarto-table-cell-role="th">street</th>
<th data-quarto-table-cell-role="th">alley</th>
<th data-quarto-table-cell-role="th">lot_shape</th>
<th data-quarto-table-cell-role="th">land_contour</th>
<th data-quarto-table-cell-role="th">utilities</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">pool_area</th>
<th data-quarto-table-cell-role="th">pool_qc</th>
<th data-quarto-table-cell-role="th">fence</th>
<th data-quarto-table-cell-role="th">misc_feature</th>
<th data-quarto-table-cell-role="th">misc_val</th>
<th data-quarto-table-cell-role="th">mo_sold</th>
<th data-quarto-table-cell-role="th">yr_sold</th>
<th data-quarto-table-cell-role="th">sale_type</th>
<th data-quarto-table-cell-role="th">sale_condition</th>
<th data-quarto-table-cell-role="th">saleprice</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>526301100</td>
<td>20</td>
<td>RL</td>
<td>141.0</td>
<td>31720</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>5</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>215000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>526350040</td>
<td>20</td>
<td>RH</td>
<td>80.0</td>
<td>11572</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>105000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>526351010</td>
<td>20</td>
<td>RL</td>
<td>81.0</td>
<td>14217</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>Gar2</td>
<td>12500</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>172000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>526353030</td>
<td>20</td>
<td>RL</td>
<td>93.0</td>
<td>11110</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>4</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>244000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>527105010</td>
<td>60</td>
<td>RL</td>
<td>74.0</td>
<td>13780</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>0</td>
<td>NaN</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>3</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>189900</td>
</tr>
</tbody>
</table>

<p>5 rows × 81 columns</p>
</div>
</div>
</div>
</section>
<section id="calculating-with-multiple-columns" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="calculating-with-multiple-columns"><span class="header-section-number">10.5</span> Calculating with Multiple Columns</h2>
<p>Up to this point, we’ve focused on performing calculations between a <strong>column (Series)</strong> and a <strong>scalar</strong> — for example, dividing every value in <code>saleprice</code> by 1,000. But <code>pandas</code> also allows you to perform operations <strong>between columns</strong> — this is known as <strong>vector-vector arithmetic</strong>.</p>
<p>Let’s look at an example where we calculate a new metric: <strong>price per square foot</strong>. We can compute this by dividing the sale price of each home by its above-ground living area (<code>gr_liv_area</code>):</p>
<div id="2cf16913" class="cell" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>price_per_sqft <span class="op">=</span> ames[<span class="st">'saleprice'</span>] <span class="op">/</span> ames[<span class="st">'gr_liv_area'</span>]</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>price_per_sqft.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>0    129.830918
1    117.187500
2    129.420617
3    115.639810
4    116.574586
dtype: float64</code></pre>
</div>
</div>
<p>Now that we’ve computed the new values, let’s add them to our DataFrame as a new column:</p>
<div id="0f5a1cc1" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>ames[<span class="st">'price_per_sqft'</span>] <span class="op">=</span> price_per_sqft</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>ames.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">pid</th>
<th data-quarto-table-cell-role="th">ms_subclass</th>
<th data-quarto-table-cell-role="th">ms_zoning</th>
<th data-quarto-table-cell-role="th">lot_frontage</th>
<th data-quarto-table-cell-role="th">lot_area</th>
<th data-quarto-table-cell-role="th">street</th>
<th data-quarto-table-cell-role="th">alley</th>
<th data-quarto-table-cell-role="th">lot_shape</th>
<th data-quarto-table-cell-role="th">land_contour</th>
<th data-quarto-table-cell-role="th">utilities</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">pool_qc</th>
<th data-quarto-table-cell-role="th">fence</th>
<th data-quarto-table-cell-role="th">misc_feature</th>
<th data-quarto-table-cell-role="th">misc_val</th>
<th data-quarto-table-cell-role="th">mo_sold</th>
<th data-quarto-table-cell-role="th">yr_sold</th>
<th data-quarto-table-cell-role="th">sale_type</th>
<th data-quarto-table-cell-role="th">sale_condition</th>
<th data-quarto-table-cell-role="th">saleprice</th>
<th data-quarto-table-cell-role="th">price_per_sqft</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>526301100</td>
<td>20</td>
<td>RL</td>
<td>141.0</td>
<td>31720</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>5</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>215000</td>
<td>129.830918</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>526350040</td>
<td>20</td>
<td>RH</td>
<td>80.0</td>
<td>11572</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>NaN</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>105000</td>
<td>117.187500</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>526351010</td>
<td>20</td>
<td>RL</td>
<td>81.0</td>
<td>14217</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>Gar2</td>
<td>12500</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>172000</td>
<td>129.420617</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>526353030</td>
<td>20</td>
<td>RL</td>
<td>93.0</td>
<td>11110</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>4</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>244000</td>
<td>115.639810</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>527105010</td>
<td>60</td>
<td>RL</td>
<td>74.0</td>
<td>13780</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>NaN</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>3</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>189900</td>
<td>116.574586</td>
</tr>
</tbody>
</table>

<p>5 rows × 82 columns</p>
</div>
</div>
</div>
<p>As before, you could write this as a one-liner:</p>
<div id="1311c02e" class="cell" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ames[<span class="st">'price_per_sqft'</span>] <span class="op">=</span> ames[<span class="st">'saleprice'</span>] <span class="op">/</span> ames[<span class="st">'gr_liv_area'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="combining-multiple-operations" class="level3">
<h3 class="anchored" data-anchor-id="combining-multiple-operations">Combining Multiple Operations</h3>
<p>You can also combine multiple columns and scalars in more complex expressions. For example, the following line combines three columns and a constant:</p>
<div id="f3fcd5f1" class="cell" data-execution_count="20">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>ames[<span class="st">'nonsense'</span>] <span class="op">=</span> (ames[<span class="st">'yr_sold'</span>] <span class="op">+</span> <span class="dv">12</span>) <span class="op">*</span> ames[<span class="st">'gr_liv_area'</span>] <span class="op">+</span> ames[<span class="st">'lot_area'</span>] <span class="op">-</span> <span class="dv">50</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>ames.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">pid</th>
<th data-quarto-table-cell-role="th">ms_subclass</th>
<th data-quarto-table-cell-role="th">ms_zoning</th>
<th data-quarto-table-cell-role="th">lot_frontage</th>
<th data-quarto-table-cell-role="th">lot_area</th>
<th data-quarto-table-cell-role="th">street</th>
<th data-quarto-table-cell-role="th">alley</th>
<th data-quarto-table-cell-role="th">lot_shape</th>
<th data-quarto-table-cell-role="th">land_contour</th>
<th data-quarto-table-cell-role="th">utilities</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">fence</th>
<th data-quarto-table-cell-role="th">misc_feature</th>
<th data-quarto-table-cell-role="th">misc_val</th>
<th data-quarto-table-cell-role="th">mo_sold</th>
<th data-quarto-table-cell-role="th">yr_sold</th>
<th data-quarto-table-cell-role="th">sale_type</th>
<th data-quarto-table-cell-role="th">sale_condition</th>
<th data-quarto-table-cell-role="th">saleprice</th>
<th data-quarto-table-cell-role="th">price_per_sqft</th>
<th data-quarto-table-cell-role="th">nonsense</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>526301100</td>
<td>20</td>
<td>RL</td>
<td>141.0</td>
<td>31720</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>5</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>215000</td>
<td>129.830918</td>
<td>3380102</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>526350040</td>
<td>20</td>
<td>RH</td>
<td>80.0</td>
<td>11572</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>105000</td>
<td>117.187500</td>
<td>1823234</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>526351010</td>
<td>20</td>
<td>RL</td>
<td>81.0</td>
<td>14217</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>NaN</td>
<td>Gar2</td>
<td>12500</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>172000</td>
<td>129.420617</td>
<td>2701405</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>526353030</td>
<td>20</td>
<td>RL</td>
<td>93.0</td>
<td>11110</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>4</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>244000</td>
<td>115.639810</td>
<td>4277480</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>527105010</td>
<td>60</td>
<td>RL</td>
<td>74.0</td>
<td>13780</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>3</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>189900</td>
<td>116.574586</td>
<td>3307568</td>
</tr>
</tbody>
</table>

<p>5 rows × 83 columns</p>
</div>
</div>
</div>
<p>This creates a column called <code>"nonsense"</code> using a mix of vector-vector and vector-scalar operations. While this particular example isn’t meaningful analytically, it shows how you can chain together multiple operations in a single expression.</p>
<p>In practice, you’ll often calculate new variables using a combination of existing columns — for example, calculating cost efficiency, total square footage, or ratios between two quantities. Being comfortable with these kinds of operations is essential for building features and preparing data for analysis or modeling.</p>
</section>
<section id="knowledge-check-2" class="level3">
<h3 class="anchored" data-anchor-id="knowledge-check-2">Knowledge check</h3>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Create a <code>price_per_total_sqft</code> variable
</div>
</div>
<div class="callout-body-container callout-body">
<p>Create a new column <code>price_per_total_sqft</code> that is <code>saleprice</code> divided by the sum of <code>gr_liv_area</code>, <code>total_bsmt_sf</code>, <code>wood_deck_sf</code>, <code>open_porch_sf</code>.</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/Mylku84SjbM?si=9QRNCSD9NppqKgRK" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</div>
</div>
</section>
</section>
<section id="working-with-string-columns" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="working-with-string-columns"><span class="header-section-number">10.6</span> Working with String Columns</h2>
<p>So far, we’ve focused on numeric calculations — things like dividing, multiplying, and creating new variables based on numbers. But many datasets also contain <strong>non-numeric</strong> values, such as names, categories, or descriptive labels.</p>
<p>In <code>pandas</code>, string data is stored as <strong>object</strong> or <strong>string</strong> type columns, and you can perform operations on them just like you would with numbers. This is especially useful for cleaning, formatting, or combining text.</p>
<section id="string-concatenation" class="level3">
<h3 class="anchored" data-anchor-id="string-concatenation">String Concatenation</h3>
<p>A common operation with string data is <strong>concatenation</strong> — combining multiple strings together. For example, suppose we want to create a descriptive sentence using the neighborhood and sale condition of each home in the Ames dataset:</p>
<div id="98423073" class="cell" data-execution_count="21">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">'Home in '</span> <span class="op">+</span> ames[<span class="st">'neighborhood'</span>] <span class="op">+</span> <span class="st">' neighborhood sold under '</span> <span class="op">+</span> ames[<span class="st">'sale_condition'</span>] <span class="op">+</span> <span class="st">' condition'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>0       Home in NAmes neighborhood sold under Normal c...
1       Home in NAmes neighborhood sold under Normal c...
2       Home in NAmes neighborhood sold under Normal c...
3       Home in NAmes neighborhood sold under Normal c...
4       Home in Gilbert neighborhood sold under Normal...
                              ...                        
2925    Home in Mitchel neighborhood sold under Normal...
2926    Home in Mitchel neighborhood sold under Normal...
2927    Home in Mitchel neighborhood sold under Normal...
2928    Home in Mitchel neighborhood sold under Normal...
2929    Home in Mitchel neighborhood sold under Normal...
Length: 2930, dtype: object</code></pre>
</div>
</div>
<p>This works just like string addition in Python. Each piece of text is combined row by row across the DataFrame to generate a new sentence for each observation.</p>
</section>
<section id="string-methods-with-.str" class="level3">
<h3 class="anchored" data-anchor-id="string-methods-with-.str">String Methods with <code>.str</code></h3>
<p>For more advanced string operations, <code>pandas</code> provides a powerful set of tools through the <code>.str</code> accessor. This gives you access to many string-specific methods like <code>.lower()</code>, <code>.replace()</code>, <code>.len()</code>, and more.</p>
<p>Here are a few examples:</p>
<div id="7089d548" class="cell" data-execution_count="22">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of characters in each neighborhood name</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>ames[<span class="st">'neighborhood'</span>].<span class="bu">str</span>.<span class="bu">len</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>0       5
1       5
2       5
3       5
4       7
       ..
2925    7
2926    7
2927    7
2928    7
2929    7
Name: neighborhood, Length: 2930, dtype: int64</code></pre>
</div>
</div>
<div id="d70f70dc" class="cell" data-execution_count="23">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize the format of garage type labels</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>ames[<span class="st">'garage_type'</span>].<span class="bu">str</span>.lower().<span class="bu">str</span>.replace(<span class="st">'tchd'</span>, <span class="st">'tached'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>0       attached
1       attached
2       attached
3       attached
4       attached
          ...   
2925    detached
2926    attached
2927         NaN
2928    attached
2929    attached
Name: garage_type, Length: 2930, dtype: object</code></pre>
</div>
</div>
<p>These methods are especially helpful when cleaning messy or inconsistent text data — for example, fixing capitalization, removing whitespace, or replacing substrings.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>In this chapter, we’ve only scratched the surface of working with non-numeric data. In later chapters, we’ll take a deeper look at how to clean, transform, and analyze string values, as well as how to work with date and time data — including parsing timestamps, extracting components like month and day, and calculating time differences.</p>
<p>For now, if you want to dig into working with string columns some more, it’s worth exploring the <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/text.html">official Pandas documentation on string methods</a> to see the full range of capabilities.</p>
</div>
</div>
</div>
<p>Whether you’re formatting text for a report, cleaning up inconsistent labels, or preparing inputs for machine learning models, working with string columns is a valuable part of your data wrangling skill set.</p>
<div id="48ea1eab" class="cell" data-execution_count="24">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>ames</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">pid</th>
<th data-quarto-table-cell-role="th">ms_subclass</th>
<th data-quarto-table-cell-role="th">ms_zoning</th>
<th data-quarto-table-cell-role="th">lot_frontage</th>
<th data-quarto-table-cell-role="th">lot_area</th>
<th data-quarto-table-cell-role="th">street</th>
<th data-quarto-table-cell-role="th">alley</th>
<th data-quarto-table-cell-role="th">lot_shape</th>
<th data-quarto-table-cell-role="th">land_contour</th>
<th data-quarto-table-cell-role="th">utilities</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">fence</th>
<th data-quarto-table-cell-role="th">misc_feature</th>
<th data-quarto-table-cell-role="th">misc_val</th>
<th data-quarto-table-cell-role="th">mo_sold</th>
<th data-quarto-table-cell-role="th">yr_sold</th>
<th data-quarto-table-cell-role="th">sale_type</th>
<th data-quarto-table-cell-role="th">sale_condition</th>
<th data-quarto-table-cell-role="th">saleprice</th>
<th data-quarto-table-cell-role="th">price_per_sqft</th>
<th data-quarto-table-cell-role="th">nonsense</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>526301100</td>
<td>20</td>
<td>RL</td>
<td>141.0</td>
<td>31720</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>5</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>215000</td>
<td>129.830918</td>
<td>3380102</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>526350040</td>
<td>20</td>
<td>RH</td>
<td>80.0</td>
<td>11572</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>105000</td>
<td>117.187500</td>
<td>1823234</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>526351010</td>
<td>20</td>
<td>RL</td>
<td>81.0</td>
<td>14217</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>NaN</td>
<td>Gar2</td>
<td>12500</td>
<td>6</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>172000</td>
<td>129.420617</td>
<td>2701405</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>526353030</td>
<td>20</td>
<td>RL</td>
<td>93.0</td>
<td>11110</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>4</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>244000</td>
<td>115.639810</td>
<td>4277480</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>527105010</td>
<td>60</td>
<td>RL</td>
<td>74.0</td>
<td>13780</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>3</td>
<td>2010</td>
<td>WD</td>
<td>Normal</td>
<td>189900</td>
<td>116.574586</td>
<td>3307568</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2925</th>
<td>923275080</td>
<td>80</td>
<td>RL</td>
<td>37.0</td>
<td>7887</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>GdPrv</td>
<td>NaN</td>
<td>0</td>
<td>3</td>
<td>2006</td>
<td>WD</td>
<td>Normal</td>
<td>142500</td>
<td>142.073779</td>
<td>2031891</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2926</th>
<td>923276100</td>
<td>20</td>
<td>RL</td>
<td>NaN</td>
<td>8835</td>
<td>Pave</td>
<td>NaN</td>
<td>IR1</td>
<td>Low</td>
<td>AllPub</td>
<td>...</td>
<td>MnPrv</td>
<td>NaN</td>
<td>0</td>
<td>6</td>
<td>2006</td>
<td>WD</td>
<td>Normal</td>
<td>131000</td>
<td>145.232816</td>
<td>1829021</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2927</th>
<td>923400125</td>
<td>85</td>
<td>RL</td>
<td>62.0</td>
<td>10391</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>MnPrv</td>
<td>Shed</td>
<td>700</td>
<td>7</td>
<td>2006</td>
<td>WD</td>
<td>Normal</td>
<td>132000</td>
<td>136.082474</td>
<td>1967801</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2928</th>
<td>924100070</td>
<td>20</td>
<td>RL</td>
<td>77.0</td>
<td>9960</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>4</td>
<td>2006</td>
<td>WD</td>
<td>Normal</td>
<td>170000</td>
<td>122.390209</td>
<td>2812912</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2929</th>
<td>924151050</td>
<td>60</td>
<td>RL</td>
<td>74.0</td>
<td>9577</td>
<td>Pave</td>
<td>NaN</td>
<td>Reg</td>
<td>Lvl</td>
<td>AllPub</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>0</td>
<td>11</td>
<td>2006</td>
<td>WD</td>
<td>Normal</td>
<td>188000</td>
<td>94.000000</td>
<td>4045527</td>
</tr>
</tbody>
</table>

<p>2930 rows × 83 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="more-complex-column-manipulation" class="level2" data-number="10.7">
<h2 data-number="10.7" class="anchored" data-anchor-id="more-complex-column-manipulation"><span class="header-section-number">10.7</span> More Complex Column Manipulation</h2>
<p>As you become more comfortable working with individual columns, you’ll often find yourself needing to do more than basic math. In this section, we’ll cover a few additional, common column operations:</p>
<ul>
<li>Replacing values using a mapping</li>
<li>Identifying and handling missing values</li>
<li>Applying custom functions</li>
</ul>
<p>These are core techniques that will serve you in any data cleaning or feature engineering workflow.</p>
<section id="replacing-values" class="level3">
<h3 class="anchored" data-anchor-id="replacing-values">Replacing Values</h3>
<p>One fairly common situation in data wrangling is needing to convert one set of values to another, where there is a one-to-one correspondence between the values currently in the column and the new values that should replace them. This operation can be described as “mapping one set of values to another”.</p>
<p>Let’s look at an example of this. In our Ames data the month sold is represented numerically:</p>
<div id="b99fabf3" class="cell" data-execution_count="25">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>ames[<span class="st">'mo_sold'</span>].head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>0    5
1    6
2    6
3    4
4    3
Name: mo_sold, dtype: int64</code></pre>
</div>
</div>
<p>Suppose we want to change this so that values are represented by the month name:</p>
<ul>
<li>1 = ‘Jan’</li>
<li>2 = ‘Feb’</li>
<li>…</li>
<li>12 = ‘Dec’</li>
</ul>
<p>We can express this <em>mapping</em> of old values to new values using a Python dictionary.</p>
<div id="5a678039" class="cell" data-execution_count="26">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Only specify the values we want to replace; don't include the ones that should stay the same.</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>value_mapping <span class="op">=</span> {</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'Jan'</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'Feb'</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'Mar'</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>: <span class="st">'Apr'</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>: <span class="st">'May'</span>,</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>: <span class="st">'Jun'</span>,</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">7</span>: <span class="st">'Jul'</span>,</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">8</span>: <span class="st">'Aug'</span>,</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">9</span>: <span class="st">'Sep'</span>,</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">10</span>: <span class="st">'Oct'</span>,</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">11</span>: <span class="st">'Nov'</span>,</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">12</span>: <span class="st">'Dec'</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Pandas provides a handy method on Series, <code>.replace</code>, that accepts this value mapping and updates the Series accordingly. We can use it to recode our values.</p>
<div id="030a3238" class="cell" data-execution_count="27">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>ames[<span class="st">'mo_sold'</span>].replace(value_mapping).head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>0    May
1    Jun
2    Jun
3    Apr
4    Mar
Name: mo_sold, dtype: object</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>If you are a SQL user, this workflow may look familiar to you; it’s quite similar to a <code>CASE WHEN</code> statement in SQL.</p>
</div>
</div>
</div>
</section>
<section id="missing-values" class="level3">
<h3 class="anchored" data-anchor-id="missing-values">Missing values</h3>
<p>In real-world datasets, missing values are common. In <code>pandas</code>, these are usually represented as <code>NaN</code> (Not a Number).</p>
<p>To detect missing values in a DataFrame, use <code>.isnull()</code>. This returns a DataFrame of the same shape with <code>True</code> where values are missing:</p>
<div id="12599319" class="cell" data-execution_count="28">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>ames.isnull()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">pid</th>
<th data-quarto-table-cell-role="th">ms_subclass</th>
<th data-quarto-table-cell-role="th">ms_zoning</th>
<th data-quarto-table-cell-role="th">lot_frontage</th>
<th data-quarto-table-cell-role="th">lot_area</th>
<th data-quarto-table-cell-role="th">street</th>
<th data-quarto-table-cell-role="th">alley</th>
<th data-quarto-table-cell-role="th">lot_shape</th>
<th data-quarto-table-cell-role="th">land_contour</th>
<th data-quarto-table-cell-role="th">utilities</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">fence</th>
<th data-quarto-table-cell-role="th">misc_feature</th>
<th data-quarto-table-cell-role="th">misc_val</th>
<th data-quarto-table-cell-role="th">mo_sold</th>
<th data-quarto-table-cell-role="th">yr_sold</th>
<th data-quarto-table-cell-role="th">sale_type</th>
<th data-quarto-table-cell-role="th">sale_condition</th>
<th data-quarto-table-cell-role="th">saleprice</th>
<th data-quarto-table-cell-role="th">price_per_sqft</th>
<th data-quarto-table-cell-role="th">nonsense</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>True</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>True</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2925</th>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2926</th>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2927</th>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2928</th>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>True</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2929</th>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>True</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>2930 rows × 83 columns</p>
</div>
</div>
</div>
<p>We can use this to easily compute the total number of missing values in each column:</p>
<div id="1216d675" class="cell" data-execution_count="29">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>ames.isnull().<span class="bu">sum</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>pid                 0
ms_subclass         0
ms_zoning           0
lot_frontage      490
lot_area            0
                 ... 
sale_type           0
sale_condition      0
saleprice           0
price_per_sqft      0
nonsense            0
Length: 83, dtype: int64</code></pre>
</div>
</div>
<p>Recall we also get this information with <code>.info()</code>. Actually, we get the inverse as <code>.info()</code> tells us how many non-null values exist in each column.</p>
<div id="db911f28" class="cell" data-execution_count="30">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>ames.info()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 2930 entries, 0 to 2929
Data columns (total 83 columns):
 #   Column           Non-Null Count  Dtype  
---  ------           --------------  -----  
 0   pid              2930 non-null   int64  
 1   ms_subclass      2930 non-null   int64  
 2   ms_zoning        2930 non-null   object 
 3   lot_frontage     2440 non-null   float64
 4   lot_area         2930 non-null   int64  
 5   street           2930 non-null   object 
 6   alley            198 non-null    object 
 7   lot_shape        2930 non-null   object 
 8   land_contour     2930 non-null   object 
 9   utilities        2930 non-null   object 
 10  lot_config       2930 non-null   object 
 11  land_slope       2930 non-null   object 
 12  neighborhood     2930 non-null   object 
 13  condition_1      2930 non-null   object 
 14  condition_2      2930 non-null   object 
 15  bldg_type        2930 non-null   object 
 16  house_style      2930 non-null   object 
 17  overall_qual     2930 non-null   int64  
 18  overall_cond     2930 non-null   int64  
 19  year_built       2930 non-null   int64  
 20  year_remod/add   2930 non-null   int64  
 21  roof_style       2930 non-null   object 
 22  roof_matl        2930 non-null   object 
 23  exterior_1st     2930 non-null   object 
 24  exterior_2nd     2930 non-null   object 
 25  mas_vnr_type     1155 non-null   object 
 26  mas_vnr_area     2907 non-null   float64
 27  exter_qual       2930 non-null   object 
 28  exter_cond       2930 non-null   object 
 29  foundation       2930 non-null   object 
 30  bsmt_qual        2850 non-null   object 
 31  bsmt_cond        2850 non-null   object 
 32  bsmt_exposure    2847 non-null   object 
 33  bsmtfin_type_1   2850 non-null   object 
 34  bsmtfin_sf_1     2929 non-null   float64
 35  bsmtfin_type_2   2849 non-null   object 
 36  bsmtfin_sf_2     2929 non-null   float64
 37  bsmt_unf_sf      2929 non-null   float64
 38  total_bsmt_sf    2929 non-null   float64
 39  heating          2930 non-null   object 
 40  heating_qc       2930 non-null   object 
 41  central_air      2930 non-null   object 
 42  electrical       2929 non-null   object 
 43  1st_flr_sf       2930 non-null   int64  
 44  2nd_flr_sf       2930 non-null   int64  
 45  low_qual_fin_sf  2930 non-null   int64  
 46  gr_liv_area      2930 non-null   int64  
 47  bsmt_full_bath   2928 non-null   float64
 48  bsmt_half_bath   2928 non-null   float64
 49  full_bath        2930 non-null   int64  
 50  half_bath        2930 non-null   int64  
 51  bedroom_abvgr    2930 non-null   int64  
 52  kitchen_abvgr    2930 non-null   int64  
 53  kitchen_qual     2930 non-null   object 
 54  totrms_abvgrd    2930 non-null   int64  
 55  functional       2930 non-null   object 
 56  fireplaces       2930 non-null   int64  
 57  fireplace_qu     1508 non-null   object 
 58  garage_type      2773 non-null   object 
 59  garage_yr_blt    2771 non-null   float64
 60  garage_finish    2771 non-null   object 
 61  garage_cars      2929 non-null   float64
 62  garage_area      2929 non-null   float64
 63  garage_qual      2771 non-null   object 
 64  garage_cond      2771 non-null   object 
 65  paved_drive      2930 non-null   object 
 66  wood_deck_sf     2930 non-null   int64  
 67  open_porch_sf    2930 non-null   int64  
 68  enclosed_porch   2930 non-null   int64  
 69  3ssn_porch       2930 non-null   int64  
 70  screen_porch     2930 non-null   int64  
 71  pool_area        2930 non-null   int64  
 72  pool_qc          13 non-null     object 
 73  fence            572 non-null    object 
 74  misc_feature     106 non-null    object 
 75  misc_val         2930 non-null   int64  
 76  mo_sold          2930 non-null   int64  
 77  yr_sold          2930 non-null   int64  
 78  sale_type        2930 non-null   object 
 79  sale_condition   2930 non-null   object 
 80  saleprice        2930 non-null   int64  
 81  price_per_sqft   2930 non-null   float64
 82  nonsense         2930 non-null   int64  
dtypes: float64(12), int64(28), object(43)
memory usage: 1.9+ MB</code></pre>
</div>
</div>
<p>We can use <code>any()</code> to identify which columns have missing values. We can use this information for various reasons such as subsetting for just those columns that have missing values.</p>
<div id="93c47349" class="cell" data-execution_count="31">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>missing <span class="op">=</span> ames.isnull().<span class="bu">any</span>() <span class="co"># identify if missing values exist in each column</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>ames[missing[missing].index]  <span class="co"># subset for just those columns that have missing values</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">lot_frontage</th>
<th data-quarto-table-cell-role="th">alley</th>
<th data-quarto-table-cell-role="th">mas_vnr_type</th>
<th data-quarto-table-cell-role="th">mas_vnr_area</th>
<th data-quarto-table-cell-role="th">bsmt_qual</th>
<th data-quarto-table-cell-role="th">bsmt_cond</th>
<th data-quarto-table-cell-role="th">bsmt_exposure</th>
<th data-quarto-table-cell-role="th">bsmtfin_type_1</th>
<th data-quarto-table-cell-role="th">bsmtfin_sf_1</th>
<th data-quarto-table-cell-role="th">bsmtfin_type_2</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">garage_type</th>
<th data-quarto-table-cell-role="th">garage_yr_blt</th>
<th data-quarto-table-cell-role="th">garage_finish</th>
<th data-quarto-table-cell-role="th">garage_cars</th>
<th data-quarto-table-cell-role="th">garage_area</th>
<th data-quarto-table-cell-role="th">garage_qual</th>
<th data-quarto-table-cell-role="th">garage_cond</th>
<th data-quarto-table-cell-role="th">pool_qc</th>
<th data-quarto-table-cell-role="th">fence</th>
<th data-quarto-table-cell-role="th">misc_feature</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>141.0</td>
<td>NaN</td>
<td>Stone</td>
<td>112.0</td>
<td>TA</td>
<td>Gd</td>
<td>Gd</td>
<td>BLQ</td>
<td>639.0</td>
<td>Unf</td>
<td>...</td>
<td>Attchd</td>
<td>1960.0</td>
<td>Fin</td>
<td>2.0</td>
<td>528.0</td>
<td>TA</td>
<td>TA</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>80.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>TA</td>
<td>TA</td>
<td>No</td>
<td>Rec</td>
<td>468.0</td>
<td>LwQ</td>
<td>...</td>
<td>Attchd</td>
<td>1961.0</td>
<td>Unf</td>
<td>1.0</td>
<td>730.0</td>
<td>TA</td>
<td>TA</td>
<td>NaN</td>
<td>MnPrv</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>81.0</td>
<td>NaN</td>
<td>BrkFace</td>
<td>108.0</td>
<td>TA</td>
<td>TA</td>
<td>No</td>
<td>ALQ</td>
<td>923.0</td>
<td>Unf</td>
<td>...</td>
<td>Attchd</td>
<td>1958.0</td>
<td>Unf</td>
<td>1.0</td>
<td>312.0</td>
<td>TA</td>
<td>TA</td>
<td>NaN</td>
<td>NaN</td>
<td>Gar2</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>93.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>TA</td>
<td>TA</td>
<td>No</td>
<td>ALQ</td>
<td>1065.0</td>
<td>Unf</td>
<td>...</td>
<td>Attchd</td>
<td>1968.0</td>
<td>Fin</td>
<td>2.0</td>
<td>522.0</td>
<td>TA</td>
<td>TA</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>74.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>Gd</td>
<td>TA</td>
<td>No</td>
<td>GLQ</td>
<td>791.0</td>
<td>Unf</td>
<td>...</td>
<td>Attchd</td>
<td>1997.0</td>
<td>Fin</td>
<td>2.0</td>
<td>482.0</td>
<td>TA</td>
<td>TA</td>
<td>NaN</td>
<td>MnPrv</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2925</th>
<td>37.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>TA</td>
<td>TA</td>
<td>Av</td>
<td>GLQ</td>
<td>819.0</td>
<td>Unf</td>
<td>...</td>
<td>Detchd</td>
<td>1984.0</td>
<td>Unf</td>
<td>2.0</td>
<td>588.0</td>
<td>TA</td>
<td>TA</td>
<td>NaN</td>
<td>GdPrv</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2926</th>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>Gd</td>
<td>TA</td>
<td>Av</td>
<td>BLQ</td>
<td>301.0</td>
<td>ALQ</td>
<td>...</td>
<td>Attchd</td>
<td>1983.0</td>
<td>Unf</td>
<td>2.0</td>
<td>484.0</td>
<td>TA</td>
<td>TA</td>
<td>NaN</td>
<td>MnPrv</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2927</th>
<td>62.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>Gd</td>
<td>TA</td>
<td>Av</td>
<td>GLQ</td>
<td>337.0</td>
<td>Unf</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>MnPrv</td>
<td>Shed</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2928</th>
<td>77.0</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>Gd</td>
<td>TA</td>
<td>Av</td>
<td>ALQ</td>
<td>1071.0</td>
<td>LwQ</td>
<td>...</td>
<td>Attchd</td>
<td>1975.0</td>
<td>RFn</td>
<td>2.0</td>
<td>418.0</td>
<td>TA</td>
<td>TA</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2929</th>
<td>74.0</td>
<td>NaN</td>
<td>BrkFace</td>
<td>94.0</td>
<td>Gd</td>
<td>TA</td>
<td>Av</td>
<td>LwQ</td>
<td>758.0</td>
<td>Unf</td>
<td>...</td>
<td>Attchd</td>
<td>1993.0</td>
<td>Fin</td>
<td>3.0</td>
<td>650.0</td>
<td>TA</td>
<td>TA</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>2930 rows × 27 columns</p>
</div>
</div>
</div>
<section id="dropping-missing-values" class="level4">
<h4 class="anchored" data-anchor-id="dropping-missing-values">Dropping Missing Values</h4>
<p>When you have missing values, we usually either drop them or impute them.You can drop missing values with <code>.dropna()</code>:</p>
<div id="1862ae86" class="cell" data-execution_count="32">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>ames.dropna()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">pid</th>
<th data-quarto-table-cell-role="th">ms_subclass</th>
<th data-quarto-table-cell-role="th">ms_zoning</th>
<th data-quarto-table-cell-role="th">lot_frontage</th>
<th data-quarto-table-cell-role="th">lot_area</th>
<th data-quarto-table-cell-role="th">street</th>
<th data-quarto-table-cell-role="th">alley</th>
<th data-quarto-table-cell-role="th">lot_shape</th>
<th data-quarto-table-cell-role="th">land_contour</th>
<th data-quarto-table-cell-role="th">utilities</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">fence</th>
<th data-quarto-table-cell-role="th">misc_feature</th>
<th data-quarto-table-cell-role="th">misc_val</th>
<th data-quarto-table-cell-role="th">mo_sold</th>
<th data-quarto-table-cell-role="th">yr_sold</th>
<th data-quarto-table-cell-role="th">sale_type</th>
<th data-quarto-table-cell-role="th">sale_condition</th>
<th data-quarto-table-cell-role="th">saleprice</th>
<th data-quarto-table-cell-role="th">price_per_sqft</th>
<th data-quarto-table-cell-role="th">nonsense</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

<p>0 rows × 83 columns</p>
</div>
</div>
</div>
<p>Whoa! What just happened? Well, this data set actually has a missing value in every single row. <code>.dropna()</code> drops every row that contains a missing value so we end up dropping <em>all</em> observations. Consequently, we probably want to figure out what’s going on with these missing values and isolate the column causing the problem and imputing the values if possible.</p>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Another “drop” method is <code>.drop_duplcates()</code> which will drop duplicated rows in your DataFrame.</p>
</div>
</div>
</div>
</section>
<section id="visualizing-missingness" class="level4">
<h4 class="anchored" data-anchor-id="visualizing-missingness">Visualizing Missingness</h4>
<p>Sometimes visualizations help identify patterns in missing values. One thing I often do is print a heatmap of my dataframe to get a feel for where my missing values are. We’ll get into data visualization in future lessons but for now here is an example using the <strong>searborn</strong> library. We can see that several variables have a lot of missing values (<code>alley</code>, <code>fireplace_qu</code>, <code>pool_qc</code>, <code>fence</code>, <code>misc_feature</code>).</p>
<div id="7def1e10" class="cell" data-execution_count="33">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(rc<span class="op">=</span>{<span class="st">'figure.figsize'</span>:(<span class="dv">12</span>, <span class="dv">8</span>)})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a71425b2" class="cell" data-execution_count="34">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>ames_missing <span class="op">=</span> ames[missing[missing].index]</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>sns.heatmap(ames_missing.isnull(), cmap<span class="op">=</span><span class="st">'viridis'</span>, cbar<span class="op">=</span><span class="va">False</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="10-manipulating-data_files/figure-html/cell-35-output-1.png" width="962" height="743" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="filling-missing-values-imputation" class="level4">
<h4 class="anchored" data-anchor-id="filling-missing-values-imputation">Filling Missing Values (Imputation)</h4>
<p>Since we can’t drop all missing values in this data set (since it leaves us with no rows), we need to impute (“fill”) them in. There are several approaches we can use to do this; one of which uses the <code>.fillna()</code> method. This method has various options for filling, you can use a fixed value, the mean of the column, the previous non-nan value, etc:</p>
<div id="f055aba4" class="cell" data-execution_count="35">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># example DataFrame with missing values</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame([[np.nan, <span class="dv">2</span>, np.nan, <span class="dv">0</span>],</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>                   [<span class="dv">3</span>, <span class="dv">4</span>, np.nan, <span class="dv">1</span>],</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>                   [np.nan, np.nan, np.nan, <span class="dv">5</span>],</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>                   [np.nan, <span class="dv">3</span>, np.nan, <span class="dv">4</span>]],</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>                  columns<span class="op">=</span><span class="bu">list</span>(<span class="st">'ABCD'</span>))</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>NaN</td>
<td>2.0</td>
<td>NaN</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>3.0</td>
<td>4.0</td>
<td>NaN</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>5</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>NaN</td>
<td>3.0</td>
<td>NaN</td>
<td>4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="1f586669" class="cell" data-execution_count="36">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>df.fillna(<span class="dv">0</span>)  <span class="co"># fill with 0</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>0.0</td>
<td>2.0</td>
<td>0.0</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>3.0</td>
<td>4.0</td>
<td>0.0</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>5</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>0.0</td>
<td>3.0</td>
<td>0.0</td>
<td>4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="b38ccfff" class="cell" data-execution_count="37">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>df.fillna(df.mean())  <span class="co"># fill with the mean</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>3.0</td>
<td>2.0</td>
<td>NaN</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>3.0</td>
<td>4.0</td>
<td>NaN</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>3.0</td>
<td>3.0</td>
<td>NaN</td>
<td>5</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>3.0</td>
<td>3.0</td>
<td>NaN</td>
<td>4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="c4832cca" class="cell" data-execution_count="38">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>df.bfill()  <span class="co"># backward (upwards) fill from non-nan values</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>3.0</td>
<td>2.0</td>
<td>NaN</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>3.0</td>
<td>4.0</td>
<td>NaN</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>NaN</td>
<td>3.0</td>
<td>NaN</td>
<td>5</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>NaN</td>
<td>3.0</td>
<td>NaN</td>
<td>4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="ae2eb02d" class="cell" data-execution_count="39">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>df.ffill()  <span class="co"># forward (downward) fill from non-nan values</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>NaN</td>
<td>2.0</td>
<td>NaN</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>3.0</td>
<td>4.0</td>
<td>NaN</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>3.0</td>
<td>4.0</td>
<td>NaN</td>
<td>5</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>3.0</td>
<td>3.0</td>
<td>NaN</td>
<td>4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="applying-custom-functions" class="level3">
<h3 class="anchored" data-anchor-id="applying-custom-functions">Applying custom functions</h3>
<p>There will be times when you want to apply a function that is not built-in to Pandas. For this, we have methods:</p>
<ul>
<li><code>df.apply()</code>, applies a function column-wise or row-wise across a dataframe (the function must be able to accept/return an array)</li>
<li><code>df.applymap()</code>, applies a function element-wise (for functions that accept/return single values at a time)</li>
<li><code>series.apply()</code>/<code>series.map()</code>, same as above but for Pandas series</li>
</ul>
<p>For example, say you had the following custom function that defines if a home is considered a luxery home simply based on the price sold.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Don’t worry, you’ll learn more about writing your own functions in future lessons!</p>
</div>
</div>
</div>
<div id="205025fa" class="cell" data-execution_count="40">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_luxery_home(x):</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> x <span class="op">&gt;</span> <span class="dv">500000</span>:</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'Luxery'</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'Non-luxery'</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>ames[<span class="st">'saleprice'</span>].<span class="bu">apply</span>(is_luxery_home)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>0       Non-luxery
1       Non-luxery
2       Non-luxery
3       Non-luxery
4       Non-luxery
           ...    
2925    Non-luxery
2926    Non-luxery
2927    Non-luxery
2928    Non-luxery
2929    Non-luxery
Name: saleprice, Length: 2930, dtype: object</code></pre>
</div>
</div>
<p>This may have been better as a lambda function, which is just a shorter approach to writing functions. This may be a bit confusing but we’ll talk more about lambda functions in the writing functions lesson. For now, just think of it as being able to write a function for single use application on the fly.</p>
<div id="2057d937" class="cell" data-execution_count="41">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>ames[<span class="st">'saleprice'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">'Luxery'</span> <span class="cf">if</span> x <span class="op">&gt;</span> <span class="dv">500000</span> <span class="cf">else</span> <span class="st">'Non-luxery'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>0       Non-luxery
1       Non-luxery
2       Non-luxery
3       Non-luxery
4       Non-luxery
           ...    
2925    Non-luxery
2926    Non-luxery
2927    Non-luxery
2928    Non-luxery
2929    Non-luxery
Name: saleprice, Length: 2930, dtype: object</code></pre>
</div>
</div>
<p>You can even use functions that require additional arguments. Just specify the arguments in <code>.apply()</code>:</p>
<div id="5dca0ef4" class="cell" data-execution_count="42">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_luxery_home(x, price):</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> x <span class="op">&gt;</span> price:</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'Luxery'</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'Non-luxery'</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>ames[<span class="st">'saleprice'</span>].<span class="bu">apply</span>(is_luxery_home, price<span class="op">=</span><span class="dv">200000</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>0           Luxery
1       Non-luxery
2       Non-luxery
3           Luxery
4       Non-luxery
           ...    
2925    Non-luxery
2926    Non-luxery
2927    Non-luxery
2928    Non-luxery
2929    Non-luxery
Name: saleprice, Length: 2930, dtype: object</code></pre>
</div>
</div>
<p>Sometimes we may have a function that we want to apply to every element across multiple columns. For example, say we wanted to convert several of the square footage variables to be represented as square meters. For this we can use the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.applymap.html"><code>.applymap()</code></a> method.</p>
<div id="5af64dd8" class="cell" data-execution_count="43">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_sq_meters(x):</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">*</span><span class="fl">0.092903</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>ames[[<span class="st">'gr_liv_area'</span>, <span class="st">'garage_area'</span>, <span class="st">'lot_area'</span>]].<span class="bu">map</span>(convert_to_sq_meters)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">gr_liv_area</th>
<th data-quarto-table-cell-role="th">garage_area</th>
<th data-quarto-table-cell-role="th">lot_area</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>153.847368</td>
<td>49.052784</td>
<td>2946.883160</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>83.241088</td>
<td>67.819190</td>
<td>1075.073516</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>123.468087</td>
<td>28.985736</td>
<td>1320.801951</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>196.025330</td>
<td>48.495366</td>
<td>1032.152330</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>151.338987</td>
<td>44.779246</td>
<td>1280.203340</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2925</th>
<td>93.181709</td>
<td>54.626964</td>
<td>732.725961</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2926</th>
<td>83.798506</td>
<td>44.965052</td>
<td>820.798005</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2927</th>
<td>90.115910</td>
<td>0.000000</td>
<td>965.355073</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2928</th>
<td>129.042267</td>
<td>38.833454</td>
<td>925.313880</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2929</th>
<td>185.806000</td>
<td>60.386950</td>
<td>889.732031</td>
</tr>
</tbody>
</table>

<p>2930 rows × 3 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="chapter-summary" class="level2" data-number="10.8">
<h2 data-number="10.8" class="anchored" data-anchor-id="chapter-summary"><span class="header-section-number">10.8</span> Chapter Summary</h2>
<p>In this chapter, you learned how to <strong>manipulate columns in a <code>pandas</code> DataFrame</strong> — a foundational skill for any kind of data analysis or modeling. You practiced working with both numeric and non-numeric data and explored common data wrangling tasks that analysts use every day.</p>
<p>Here’s a recap of what you learned:</p>
<ul>
<li>How to <strong>rename columns</strong> using <code>.rename()</code> or string methods like <code>.str.lower()</code> and <code>.str.replace()</code></li>
<li>How to <strong>create new columns</strong> by performing arithmetic with scalars or other columns</li>
<li>How to <strong>remove columns</strong> using <code>.drop()</code></li>
<li>How to <strong>work with text data</strong>, including string concatenation and using the <code>.str</code> accessor</li>
<li>How to <strong>replace values</strong> using a mapping (via <code>.replace()</code>)</li>
<li>How to <strong>detect and handle missing values</strong> using <code>.isnull()</code>, <code>.dropna()</code>, and <code>.fillna()</code></li>
<li>How to <strong>apply custom functions</strong> to transform your data using <code>.apply()</code> and <code>.applymap()</code></li>
</ul>
<p>These skills form the building blocks of effective data cleaning and transformation.</p>
<p>In the next few chapters, we’ll build on this foundation and introduce even more essential <strong>data wrangling techniques</strong>, including:</p>
<ul>
<li>Computing summary statistics and descriptive analytics</li>
<li>Grouping and aggregating data</li>
<li>Joining multiple datasets</li>
<li>Reshaping data with pivot tables and the <code>.melt()</code> and <code>.pivot()</code> methods</li>
</ul>
<p>By the end of these upcoming lessons, you’ll be well-equipped to clean, prepare, and explore real-world datasets using <code>pandas</code>.</p>
</section>
<section id="exercise-heart-disease-data" class="level2" data-number="10.9">
<h2 data-number="10.9" class="anchored" data-anchor-id="exercise-heart-disease-data"><span class="header-section-number">10.9</span> Exercise: Heart Disease Data</h2>
<p>In this exercise, you’ll apply what you’ve learned in this chapter to a new dataset on <strong>heart disease</strong>, which includes various patient health indicators that may be predictive of cardiovascular conditions.</p>
<p>Read more about this dataset on <a href="https://www.kaggle.com/datasets/johnsmith88/heart-disease-dataset">Kaggle</a>, and you can download copy of the <code>heart.csv</code> file <a href="https://github.com/bradleyboehmke/uc-bana-4080/blob/main/data/heart.csv">here</a>.</p>
<p>Your task is to perform several data wrangling steps to start cleaning and transforming this dataset.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Import the Data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Load the dataset into a DataFrame using <code>pd.read_csv()</code>.</li>
<li>Preview the first few rows with <code>.head()</code>.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Clean the Column Names
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Check out the column names and think how you would standardize these names. Use <code>.columns</code> and string methods to:</p>
<ul>
<li>Convert all column names to <strong>lowercase</strong></li>
<li>Replace any spaces or dashes with <strong>underscores</strong></li>
<li>Remove any trailing or leading whitespace</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Handle Missing Values
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Check for missing values using <code>.isnull().sum()</code>.</li>
<li>If any columns contain missing values:
<ul>
<li>Identify the <strong>mode</strong> (most frequent value) for those columns</li>
<li>Fill the missing values using <code>.fillna()</code></li>
</ul></li>
</ul>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The mode can be accessed with <code>.mode().iloc[0]</code> to retrieve the most frequent value.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Create a New Column
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Create a new column called <code>risk</code>, calculated as:</p>
<p><span class="math display">\[
     \text{risk} = \frac{\text{age}}{\text{rest\_bp} + \text{chol} + \text{max\_hr}}
\]</span></p>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Be sure to use parentheses in your formula to ensure proper order of operations.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Replace Values in a Categorical Column
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The <code>rest_ecg</code> column contains several text categories. Recode the values using <code>.replace()</code> and the following mapping:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Original Value</th>
<th>New Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>normal</td>
<td>normal</td>
</tr>
<tr class="even">
<td>left ventricular hypertrophy</td>
<td>lvh</td>
</tr>
<tr class="odd">
<td>ST-T wave abnormality</td>
<td>stt_wav_abn</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Make sure to overwrite the existing column with the updated values.</p>
</div>
</div>
</div>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./09-subsetting.html" class="pagination-link" aria-label="Subsetting Data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Subsetting Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./11_aggregating_data.html" class="pagination-link" aria-label="Summarizing Data">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Summarizing Data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/bradleyboehmke/uc-bana-4080/edit/main/10-manipulating-data.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/bradleyboehmke/uc-bana-4080/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>